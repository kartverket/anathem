   var gkopen="http://opencache.statkart.no/gatekeeper/gk/gk.open";
   OpenLayers.Util.onImageLoadErrorColor = 'transparent';

   var UTM33 = new OpenLayers.Projection('EPSG:32633');
   var UTM32 = new OpenLayers.Projection('EPSG:32632');
   var UTM35 = new OpenLayers.Projection('EPSG:32635');
   var WSG84 = new OpenLayers.Projection('EPSG:4326');
   var mapProj = UTM33;
   var mapBounds = new OpenLayers.Bounds(-2500000.0,3500000.0,3045984.0,9045984.0); 

   Proj4js.defs["EPSG:4326"]="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";
   Proj4js.defs["EPSG:32632"]="+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs";
   Proj4js.defs["EPSG:32633"]="+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs";
   Proj4js.defs["EPSG:32635"]="+proj=utm +zone=35 +ellps=WGS84 +datum=WGS84 +units=m +no_defs";

   var xdmsocket = new easyXDM.Socket({});
   var initLayers;

   function init(){
// Create map canvas

      var map;        

      var updateHistory = function(evt){
        if (!!map) {
          var center = map.getCenter();
          var zoom   = map.getZoom();
          if (!!center && !!zoom) {
            uid = zoom+"/"+Math.round(center.lon)+"/"+Math.round(center.lat); /* 1m precision ought to be enough for everyone --BG */
            if (!!initLayers && !!map.layers) { 
              for (i in map.layers) {
                var layer = map.layers[i];
                if (layer.visibility) {
                  if ($.inArray(layer.shortid, initLayers)==-1) {
                    uid += "/+"+layer.shortid
                  }
                } else {
                  if ($.inArray(layer.shortid, initLayers)>-1) {
                    uid += "/-"+layer.shortid
                  }
                }
              }
              window.location.hash = uid;
            }
          }
        }
      };

      map = new OpenLayers.Map( 'map', {
      	 //controls: [new OpenLayers.Control.PanZoomBar()],
      	 projection: mapProj,
      	 maxExtent:  mapBounds,
      	 units: "m",
      	 maxResolution: 21664.0,
      	 numZoomLevels: 18,

         eventListeners: {
           "moveend": updateHistory,
           "zoomend": updateHistory,
           "changelayer": updateHistory,
           "changebaselayer": updateHistory
         }
      } );

// Base layers
      ${baselayers}
// Placement and zoom of the map
      ${center}
// Overlays
      ${overlays}
// Add controls at the end, to keep focus
      ${controls}
    }
